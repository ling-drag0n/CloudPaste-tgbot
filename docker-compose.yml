version: "3.8"

services:
  cloudpaste-tg-botapi:
    # ghcr.io/ling-drag0n/cloudpaste-tg-botapi:latest
    image: dragon730/cloudpaste-tg-botapi:latest
    container_name: cloudpaste-tg-botapi
    restart: unless-stopped
    ports:
      # 端口映射：宿主机端口:容器端口
      - "7860:7860"
    volumes:
      # 持久化 telegram-bot-api 工作目录（缓存文件）
      - tg_bot_api_data:/var/lib/telegram-bot-api
    environment:
      # === 必填配置 ===
      # 从 https://my.telegram.org/apps 获取
      TELEGRAM_API_ID: ""
      TELEGRAM_API_HASH: ""
      # 从 BotFather 获取，代理层 URL 会用到 /tg/bot<TOKEN>/...
      BOT_TOKEN: ""

      # === 代理配置 ===
      # URL 前缀，默认 /tg，填 "/" 表示无前缀
      TELEGRAM_PROXY_PREFIX: "/tg"

      # === 目录配置 ===
      # 工作目录（缓存/落盘）
      TELEGRAM_WORK_DIR: "/var/lib/telegram-bot-api"
      # 临时目录（可不持久化）
      TELEGRAM_TEMP_DIR: "/tmp/telegram-bot-api-tmp"

      # === 性能配置 ===
      # 日志级别：1~5，越大越详细
      TELEGRAM_VERBOSITY: "1"
      # 文件下载等待时间（秒），网络慢时可调大
      TELEGRAM_DOWNLOAD_WAIT_SECONDS: "8"
      # 下载轮询间隔（毫秒）
      TELEGRAM_DOWNLOAD_POLL_INTERVAL_MS: "200"

volumes:
  tg_bot_api_data:
